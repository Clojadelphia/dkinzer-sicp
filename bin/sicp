#!/bin/bash
set -e

source ./lib/colors.sh

for file in $(ls ./src/*.scm)
do
  echo -e "$Yel Running Problem Set: $file $RCol"
  echo ""

  declare -a RESULTS
  RESULTS=$(cat $file | scheme --quiet --eval)

  OIFS=$IFS
  IFS=$'\n'
  for result in $RESULTS
  do
    if [[ $result == *PASSED* ]]
    then
      color=$Gre
    elif [[ $result == *FAILED* ]]
    then
      color=$Red
    elif [[ $result == *TEST* ]]
    then
      color=$Cya
    fi
    echo -e "$color $result $RCol\n"
  done
  IFS=$OIFS
done
